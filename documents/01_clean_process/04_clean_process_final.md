ğŸ¯ ULTRA-SIMPLE CATEGORICAL CONSOLIDATION
================================================================================
ğŸ“‹ Objective: Ultra-simple categories (4-5 max) for production stability
ğŸ¯ Strategy: Keep only top 3-4 categories, rest â†’ 'Others'
ğŸ“Š Target: 60-80% coverage with main categories

ğŸš€ APPLYING ULTRA-CONSOLIDATION TO df_clientes
============================================================

ğŸ” TOP CATEGORIES ANALYSIS: ocupacion
==================================================
ğŸ“Š Total categories: 245
ğŸ“Š Total records: 29,312

ğŸ† Top 8 categories:
    1. 'JUBILADO                                ...': 4,862 (16.6%) | Cumulative: 16.6%
    2. 'DOCENTE                                 ...': 2,080 (7.1%) | Cumulative: 23.7%
    3. 'POLICIA                                 ...': 1,578 (5.4%) | Cumulative: 29.1%
    4. 'OFICINISTAS                             ...': 1,070 (3.7%) | Cumulative: 32.7%
    5. 'SUPERVISOR                              ...': 1,049 (3.6%) | Cumulative: 36.3%
    6. 'ASISTENTE                               ...': 894 (3.0%) | Cumulative: 39.3%
    7. 'SECRETARIAS                             ...': 829 (2.8%) | Cumulative: 42.2%
    8. 'ADMINISTRADOR                           ...': 828 (2.8%) | Cumulative: 45.0%

ğŸ“ˆ Coverage analysis:
   Keep top 3: 29.1% coverage, 20,792 records (70.9%) â†’ 'Others'
   Keep top 4: 32.7% coverage, 19,722 records (67.3%) â†’ 'Others'
   Keep top 5: 36.3% coverage, 18,673 records (63.7%) â†’ 'Others'
   Keep top 6: 39.3% coverage, 17,779 records (60.7%) â†’ 'Others'
   Keep top 7: 42.2% coverage, 16,950 records (57.8%) â†’ 'Others'
   Keep top 8: 45.0% coverage, 16,122 records (55.0%) â†’ 'Others'

ğŸ” TOP CATEGORIES ANALYSIS: ciudad
==================================================
ğŸ“Š Total categories: 78
ğŸ“Š Total records: 28,821

ğŸ† Top 8 categories:
    1. 'PANAMA                                  ...': 10,010 (34.7%) | Cumulative: 34.7%
    2. 'ARRAIJAN                                ...': 2,968 (10.3%) | Cumulative: 45.0%
    3. 'SAN MIGUELITO                           ...': 2,888 (10.0%) | Cumulative: 55.1%
    4. 'LA CHORRERA                             ...': 2,572 (8.9%) | Cumulative: 64.0%
    5. 'DAVID                                   ...': 1,758 (6.1%) | Cumulative: 70.1%
    6. 'COLON                                   ...': 1,032 (3.6%) | Cumulative: 73.7%
    7. 'CHITRE                                  ...': 904 (3.1%) | Cumulative: 76.8%
    8. 'SANTIAGO                                ...': 898 (3.1%) | Cumulative: 79.9%

ğŸ“ˆ Coverage analysis:
   Keep top 3: 55.1% coverage, 12,955 records (44.9%) â†’ 'Others'
   Keep top 4: 64.0% coverage, 10,383 records (36.0%) â†’ 'Others'
   Keep top 5: 70.1% coverage, 8,625 records (29.9%) â†’ 'Others'
   Keep top 6: 73.7% coverage, 7,593 records (26.3%) â†’ 'Others'
   Keep top 7: 76.8% coverage, 6,689 records (23.2%) â†’ 'Others'
   Keep top 8: 79.9% coverage, 5,791 records (20.1%) â†’ 'Others'

ğŸ” TOP CATEGORIES ANALYSIS: nombreempleadorcliente
==================================================
ğŸ“Š Total categories: 7,698
ğŸ“Š Total records: 27,863

ğŸ† Top 8 categories:
    1. 'NO APLICA...': 4,212 (15.1%) | Cumulative: 15.1%
    2. 'MINISTERIO DE EDUCACION...': 2,299 (8.3%) | Cumulative: 23.4%
    3. 'MINISTERIO DE SEGURIDAD PUBLICA...': 1,468 (5.3%) | Cumulative: 28.6%
    4. 'CAJA DE SEGURO SOCIAL...': 1,352 (4.9%) | Cumulative: 33.5%
    5. 'CAJA DE AHORROS...': 1,027 (3.7%) | Cumulative: 37.2%
    6. 'MINISTERIO DE SALUD...': 786 (2.8%) | Cumulative: 40.0%
    7. 'INDEPENDIENTE...': 395 (1.4%) | Cumulative: 41.4%
    8. 'ORGANO JUDICIAL...': 331 (1.2%) | Cumulative: 42.6%

ğŸ“ˆ Coverage analysis:
   Keep top 3: 28.6% coverage, 19,884 records (71.4%) â†’ 'Others'
   Keep top 4: 33.5% coverage, 18,532 records (66.5%) â†’ 'Others'
   Keep top 5: 37.2% coverage, 17,505 records (62.8%) â†’ 'Others'
   Keep top 6: 40.0% coverage, 16,719 records (60.0%) â†’ 'Others'
   Keep top 7: 41.4% coverage, 16,324 records (58.6%) â†’ 'Others'
   Keep top 8: 42.6% coverage, 15,993 records (57.4%) â†’ 'Others'

ğŸ” TOP CATEGORIES ANALYSIS: cargoempleocliente
==================================================
ğŸ“Š Total categories: 2,178
ğŸ“Š Total records: 21,836

ğŸ† Top 8 categories:
    1. 'JUBILADO...': 2,861 (13.1%) | Cumulative: 13.1%
    2. 'POLICIA...': 1,094 (5.0%) | Cumulative: 18.1%
    3. 'DOCENTE...': 988 (4.5%) | Cumulative: 22.6%
    4. 'SECRETARIA...': 641 (2.9%) | Cumulative: 25.6%
    5. 'SUPERVISOR...': 641 (2.9%) | Cumulative: 28.5%
    6. 'OFICINISTA...': 619 (2.8%) | Cumulative: 31.3%
    7. 'ASISTENTE...': 610 (2.8%) | Cumulative: 34.1%
    8. 'VENDEDOR...': 476 (2.2%) | Cumulative: 36.3%

ğŸ“ˆ Coverage analysis:
   Keep top 3: 22.6% coverage, 16,893 records (77.4%) â†’ 'Others'
   Keep top 4: 25.6% coverage, 16,252 records (74.4%) â†’ 'Others'
   Keep top 5: 28.5% coverage, 15,611 records (71.5%) â†’ 'Others'
   Keep top 6: 31.3% coverage, 14,992 records (68.7%) â†’ 'Others'
   Keep top 7: 34.1% coverage, 14,382 records (65.9%) â†’ 'Others'
   Keep top 8: 36.3% coverage, 13,906 records (63.7%) â†’ 'Others'

ğŸ” TOP CATEGORIES ANALYSIS: sexo
==================================================
ğŸ“Š Total categories: 2
ğŸ“Š Total records: 29,319

ğŸ† Top 8 categories:
    1. 'Femenino...': 22,917 (78.2%) | Cumulative: 78.2%
    2. 'Masculino...': 6,402 (21.8%) | Cumulative: 100.0%

ğŸ“ˆ Coverage analysis:

ğŸ” TOP CATEGORIES ANALYSIS: estado_civil
==================================================
ğŸ“Š Total categories: 4
ğŸ“Š Total records: 29,319

ğŸ† Top 8 categories:
    1. 'Soltero...': 16,705 (57.0%) | Cumulative: 57.0%
    2. 'Casado...': 12,590 (42.9%) | Cumulative: 99.9%
    3. 'Otros...': 21 (0.1%) | Cumulative: 100.0%
    4. 'Divorciado...': 3 (0.0%) | Cumulative: 100.0%

ğŸ“ˆ Coverage analysis:
   Keep top 3: 100.0% coverage, 3 records (0.0%) â†’ 'Others'
   Keep top 4: 100.0% coverage, 0 records (0.0%) â†’ 'Others'

ğŸ” TOP CATEGORIES ANALYSIS: pais
==================================================
ğŸ“Š Total categories: 16
ğŸ“Š Total records: 29,319

ğŸ† Top 8 categories:
    1. 'PANAMA                                  ...': 29,295 (99.9%) | Cumulative: 99.9%
    2. 'COLOMBIA                                ...': 4 (0.0%) | Cumulative: 99.9%
    3. 'NICARAGUA                               ...': 3 (0.0%) | Cumulative: 99.9%
    4. 'EL SALVADOR                             ...': 3 (0.0%) | Cumulative: 100.0%
    5. 'PALESTINA                               ...': 2 (0.0%) | Cumulative: 100.0%
    6. 'PERU                                    ...': 2 (0.0%) | Cumulative: 100.0%
    7. 'BELICE                                  ...': 1 (0.0%) | Cumulative: 100.0%
    8. 'BRASIL                                  ...': 1 (0.0%) | Cumulative: 100.0%

ğŸ“ˆ Coverage analysis:
   Keep top 3: 99.9% coverage, 17 records (0.1%) â†’ 'Others'
   Keep top 4: 100.0% coverage, 14 records (0.0%) â†’ 'Others'
   Keep top 5: 100.0% coverage, 12 records (0.0%) â†’ 'Others'
   Keep top 6: 100.0% coverage, 10 records (0.0%) â†’ 'Others'
   Keep top 7: 100.0% coverage, 9 records (0.0%) â†’ 'Others'
   Keep top 8: 100.0% coverage, 8 records (0.0%) â†’ 'Others'

ğŸ¯ RECOMMENDED CONSOLIDATION RULES (ADJUSTABLE)
============================================================
ğŸ“ Based on the analysis above, here are suggested rules:
   You can modify these numbers based on what you see!

ğŸ“‹ CURRENT RULES:
   ocupacion: Keep top 6 categories
   ciudad: Keep top 5 categories
   nombreempleadorcliente: Keep top 6 categories
   cargoempleocliente: Keep top 6 categories
   sexo: Keep top 2 categories
   estado_civil: Keep top 2 categories
   pais: Keep top 1 categories

ğŸ”¥ Processing: ocupacion (max 6 categories)

ğŸ”¥ ULTRA-CONSOLIDATION: ocupacion
============================================================
ğŸ“Š Original state:
   Total non-null values: 29,312
   Unique categories: 245
   Missing values: 7

ğŸ¯ Ultra-consolidation result:
   Keep: 6 categories (11,533 records, 39.3%)
   â†’ 'Others': 239 categories (17,779 records, 60.7%)
   Final categories: 7

ğŸ† Categories to KEEP:
   1. 'JUBILADO                                     ': 4,862 (16.6%)
   2. 'DOCENTE                                      ': 2,080 (7.1%)
   3. 'POLICIA                                      ': 1,578 (5.4%)
   4. 'OFICINISTAS                                  ': 1,070 (3.7%)
   5. 'SUPERVISOR                                   ': 1,049 (3.6%)
   6. 'ASISTENTE                                    ': 894 (3.0%)
   âœ… Created ultra-consolidated column
   âœ… Created: ocupacion_ultra

ğŸ”¥ Processing: ciudad (max 5 categories)

ğŸ”¥ ULTRA-CONSOLIDATION: ciudad
============================================================
ğŸ“Š Original state:
   Total non-null values: 28,821
   Unique categories: 78
   Missing values: 498

ğŸ¯ Ultra-consolidation result:
   Keep: 5 categories (20,196 records, 70.1%)
   â†’ 'Others': 73 categories (8,625 records, 29.9%)
   Final categories: 6

ğŸ† Categories to KEEP:
   1. 'PANAMA                                       ': 10,010 (34.7%)
   2. 'ARRAIJAN                                     ': 2,968 (10.3%)
   3. 'SAN MIGUELITO                                ': 2,888 (10.0%)
   4. 'LA CHORRERA                                  ': 2,572 (8.9%)
   5. 'DAVID                                        ': 1,758 (6.1%)
   âœ… Created ultra-consolidated column
   âœ… Created: ciudad_ultra

ğŸ”¥ Processing: nombreempleadorcliente (max 6 categories)

ğŸ”¥ ULTRA-CONSOLIDATION: nombreempleadorcliente
============================================================
ğŸ“Š Original state:
   Total non-null values: 27,863
   Unique categories: 7,698
   Missing values: 1,456

ğŸ¯ Ultra-consolidation result:
   Keep: 6 categories (11,144 records, 40.0%)
   â†’ 'Others': 7692 categories (16,719 records, 60.0%)
   Final categories: 7

ğŸ† Categories to KEEP:
   1. 'NO APLICA': 4,212 (15.1%)
   2. 'MINISTERIO DE EDUCACION': 2,299 (8.3%)
   3. 'MINISTERIO DE SEGURIDAD PUBLICA': 1,468 (5.3%)
   4. 'CAJA DE SEGURO SOCIAL': 1,352 (4.9%)
   5. 'CAJA DE AHORROS': 1,027 (3.7%)
   6. 'MINISTERIO DE SALUD': 786 (2.8%)
   âœ… Created ultra-consolidated column
   âœ… Created: nombreempleadorcliente_ultra

ğŸ”¥ Processing: cargoempleocliente (max 6 categories)

ğŸ”¥ ULTRA-CONSOLIDATION: cargoempleocliente
============================================================
ğŸ“Š Original state:
   Total non-null values: 21,836
   Unique categories: 2,178
   Missing values: 7,483

ğŸ¯ Ultra-consolidation result:
   Keep: 6 categories (6,844 records, 31.3%)
   â†’ 'Others': 2172 categories (14,992 records, 68.7%)
   Final categories: 7

ğŸ† Categories to KEEP:
   1. 'JUBILADO': 2,861 (13.1%)
   2. 'POLICIA': 1,094 (5.0%)
   3. 'DOCENTE': 988 (4.5%)
   4. 'SECRETARIA': 641 (2.9%)
   5. 'SUPERVISOR': 641 (2.9%)
   6. 'OFICINISTA': 619 (2.8%)
   âœ… Created ultra-consolidated column
   âœ… Created: cargoempleocliente_ultra

ğŸ”¥ Processing: sexo (max 2 categories)

ğŸ”¥ ULTRA-CONSOLIDATION: sexo
============================================================
ğŸ“Š Original state:
   Total non-null values: 29,319
   Unique categories: 2
   Missing values: 0

ğŸ¯ Ultra-consolidation result:
   Keep: 2 categories (29,319 records, 100.0%)
   â†’ 'Others': 0 categories (0 records, 0.0%)
   Final categories: 2

ğŸ† Categories to KEEP:
   1. 'Femenino': 22,917 (78.2%)
   2. 'Masculino': 6,402 (21.8%)
   âœ… Created ultra-consolidated column
   âœ… Created: sexo_ultra

ğŸ”¥ Processing: estado_civil (max 2 categories)

ğŸ”¥ ULTRA-CONSOLIDATION: estado_civil
============================================================
ğŸ“Š Original state:
   Total non-null values: 29,319
   Unique categories: 4
   Missing values: 0

ğŸ¯ Ultra-consolidation result:
   Keep: 2 categories (29,295 records, 99.9%)
   â†’ 'Others': 2 categories (24 records, 0.1%)
   Final categories: 3

ğŸ† Categories to KEEP:
   1. 'Soltero': 16,705 (57.0%)
   2. 'Casado': 12,590 (42.9%)
   âœ… Created ultra-consolidated column
   âœ… Created: estado_civil_ultra

ğŸ”¥ Processing: pais (max 1 categories)

ğŸ”¥ ULTRA-CONSOLIDATION: pais
============================================================
ğŸ“Š Original state:
   Total non-null values: 29,319
   Unique categories: 16
   Missing values: 0

ğŸ¯ Ultra-consolidation result:
   Keep: 1 categories (29,295 records, 99.9%)
   â†’ 'Others': 15 categories (24 records, 0.1%)
   Final categories: 2

ğŸ† Categories to KEEP:
   1. 'PANAMA                                       ': 29,295 (99.9%)
   âœ… Created ultra-consolidated column
   âœ… Created: pais_ultra

âœ… ULTRA-CONSOLIDATION VALIDATION
============================================================

ğŸ“Š ocupacion â†’ ocupacion_ultra:
   Original categories: 245
   Final categories: 7
   Reduction: 97.1%
   Final distribution:
     'Others': 17,786 (60.7%)
     'JUBILADO                                     ': 4,862 (16.6%)
     'DOCENTE                                      ': 2,080 (7.1%)
     'POLICIA                                      ': 1,578 (5.4%)
     'OFICINISTAS                                  ': 1,070 (3.6%)
     'SUPERVISOR                                   ': 1,049 (3.6%)
     'ASISTENTE                                    ': 894 (3.0%)

ğŸ“Š ciudad â†’ ciudad_ultra:
   Original categories: 78
   Final categories: 6
   Reduction: 92.3%
   Final distribution:
     'PANAMA                                       ': 10,010 (34.1%)
     'Others': 9,123 (31.1%)
     'ARRAIJAN                                     ': 2,968 (10.1%)
     'SAN MIGUELITO                                ': 2,888 (9.9%)
     'LA CHORRERA                                  ': 2,572 (8.8%)
     'DAVID                                        ': 1,758 (6.0%)

ğŸ“Š nombreempleadorcliente â†’ nombreempleadorcliente_ultra:
   Original categories: 7,698
   Final categories: 7
   Reduction: 99.9%
   Final distribution:
     'Others': 18,175 (62.0%)
     'NO APLICA': 4,212 (14.4%)
     'MINISTERIO DE EDUCACION': 2,299 (7.8%)
     'MINISTERIO DE SEGURIDAD PUBLICA': 1,468 (5.0%)
     'CAJA DE SEGURO SOCIAL': 1,352 (4.6%)
     'CAJA DE AHORROS': 1,027 (3.5%)
     'MINISTERIO DE SALUD': 786 (2.7%)

ğŸ“Š cargoempleocliente â†’ cargoempleocliente_ultra:
   Original categories: 2,178
   Final categories: 7
   Reduction: 99.7%
   Final distribution:
     'Others': 22,475 (76.7%)
     'JUBILADO': 2,861 (9.8%)
     'POLICIA': 1,094 (3.7%)
     'DOCENTE': 988 (3.4%)
     'SECRETARIA': 641 (2.2%)
     'SUPERVISOR': 641 (2.2%)
     'OFICINISTA': 619 (2.1%)

ğŸ“Š sexo â†’ sexo_ultra:
   Original categories: 2
   Final categories: 2
   Reduction: 0.0%
   Final distribution:
     'Femenino': 22,917 (78.2%)
     'Masculino': 6,402 (21.8%)

ğŸ“Š estado_civil â†’ estado_civil_ultra:
   Original categories: 4
   Final categories: 3
   Reduction: 25.0%
   Final distribution:
     'Soltero': 16,705 (57.0%)
     'Casado': 12,590 (42.9%)
     'Others': 24 (0.1%)

ğŸ“Š pais â†’ pais_ultra:
   Original categories: 16
   Final categories: 2
   Reduction: 87.5%
   Final distribution:
     'PANAMA                                       ': 29,295 (99.9%)
     'Others': 24 (0.1%)

ğŸ“ˆ ULTRA-CONSOLIDATION SUMMARY
============================================================
ğŸ“Š Overall impact:
   Total original categories: 10,221
   Total final categories: 34
   Overall reduction: 99.7%

ğŸ“‹ Per-feature summary:
   ocupacion: 245 â†’ 7 categories (97.1% reduction)
   ciudad: 78 â†’ 6 categories (92.3% reduction)
   nombreempleadorcliente: 7,698 â†’ 7 categories (99.9% reduction)
   cargoempleocliente: 2,178 â†’ 7 categories (99.7% reduction)
   sexo: 2 â†’ 2 categories (0.0% reduction)
   estado_civil: 4 â†’ 3 categories (25.0% reduction)
   pais: 16 â†’ 2 categories (87.5% reduction)

ğŸ“Š CREATING BEFORE/AFTER CONSOLIDATION VISUALIZATIONS
============================================================

ğŸ“ˆ CONSOLIDATION IMPACT SUMMARY:
   ocupacion: 245 â†’ 7 categories (97.1% reduction)
   ciudad: 78 â†’ 6 categories (92.3% reduction)
   nombreempleadorcliente: 7698 â†’ 7 categories (99.9% reduction)
   cargoempleocliente: 2178 â†’ 7 categories (99.7% reduction)

ğŸ”§ CREATING df_clientes_consolidated FOR NEXT STEPS
==================================================
   âœ… Created: ocupacion_consolidated
   âœ… Created: ciudad_consolidated
   âœ… Created: nombreempleadorcliente_consolidated
   âœ… Created: cargoempleocliente_consolidated
   âœ… Created: sexo_consolidated
   âœ… Created: estado_civil_consolidated
   âœ… Created: pais_consolidated

ğŸ¯ ULTRA-CONSOLIDATED FEATURES FOR MODELING:
   ocupacion_consolidated: 7 categories
   ciudad_consolidated: 6 categories
   nombreempleadorcliente_consolidated: 7 categories
   cargoempleocliente_consolidated: 7 categories
   sexo_consolidated: 2 categories
   estado_civil_consolidated: 3 categories
   pais_consolidated: 2 categories

ğŸ’¾ DATASET READY:
   df_clientes_consolidated: (29319, 41)
   Ultra-simple categorical features: 7

ğŸ‰ ULTRA-CONSOLIDATION COMPLETE!
ğŸ“ Next steps:
   1. Continue with your notebook workflow
   2. Use the '_consolidated' columns for feature engineering
   3. Apply frequency encoding to these ultra-simple categories
   4. Train your model with production-safe features